!function(){var e,t,n;!function(a){function o(e,t){return C.call(e,t)}function s(e,t){var n,a,o,s,r,i,l,p,c,m,u=t&&t.split("/"),d=y.map,g=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(u=u.slice(0,u.length-1),e=u.concat(e.split("/")),p=0;p<e.length;p+=1)if(m=e[p],"."===m)e.splice(p,1),p-=1;else if(".."===m){if(1===p&&(".."===e[2]||".."===e[0]))break;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((u||g)&&d){for(n=e.split("/"),p=n.length;p>0;p-=1){if(a=n.slice(0,p).join("/"),u)for(c=u.length;c>0;c-=1)if(o=d[u.slice(0,c).join("/")],o&&(o=o[a])){s=o,r=p;break}if(s)break;!i&&g&&g[a]&&(i=g[a],l=p)}!s&&i&&(s=i,r=l),s&&(n.splice(0,r,s),e=n.join("/"))}return e}function r(e,t){return function(){return d.apply(a,S.call(arguments,0).concat([e,t]))}}function i(e){return function(t){return s(t,e)}}function l(e){return function(t){h[e]=t}}function p(e){if(o(v,e)){var t=v[e];delete v[e],b[e]=!0,u.apply(a,t)}if(!o(h,e)&&!o(b,e))throw new Error("No "+e);return h[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function m(e){return function(){return y&&y.config&&y.config[e]||{}}}var u,d,g,f,h={},v={},y={},b={},C=Object.prototype.hasOwnProperty,S=[].slice;g=function(e,t){var n,a=c(e),o=a[0];return e=a[1],o&&(o=s(o,t),n=p(o)),o?e=n&&n.normalize?n.normalize(e,i(t)):s(e,t):(e=s(e,t),a=c(e),o=a[0],e=a[1],o&&(n=p(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},f={require:function(e){return r(e)},exports:function(e){var t=h[e];return"undefined"!=typeof t?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:m(e)}}},u=function(e,t,n,s){var i,c,m,u,d,y,C=[];if(s=s||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(u=g(t[d],s),c=u.f,"require"===c)C[d]=f.require(e);else if("exports"===c)C[d]=f.exports(e),y=!0;else if("module"===c)i=C[d]=f.module(e);else if(o(h,c)||o(v,c)||o(b,c))C[d]=p(c);else{if(!u.p)throw new Error(e+" missing "+c);u.p.load(u.n,r(s,!0),l(c),{}),C[d]=h[c]}m=n.apply(h[e],C),e&&(i&&i.exports!==a&&i.exports!==h[e]?h[e]=i.exports:m===a&&y||(h[e]=m))}else e&&(h[e]=n)},e=t=d=function(e,t,n,o,s){return"string"==typeof e?f[e]?f[e](t):p(g(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=n,n=null):e=a),t=t||function(){},"function"==typeof n&&(n=o,o=s),o?u(a,e,t,n):setTimeout(function(){u(a,e,t,n)},4),d)},d.config=function(e){return y=e,y.deps&&d(y.deps,y.callback),d},n=function(e,t,n){t.splice||(n=t,t=[]),o(h,e)||o(v,e)||(v[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../../vendor/almond/almond",function(){}),n("common/mini-class",[],function(){function e(e,t){var n,a={}.hasOwnProperty;for(n in t)a.call(t,n)&&(e[n]=t[n])}function t(t,n){function a(){this.constructor=t}e(t,n),a.prototype=n.prototype,t.prototype=new a,t.__super__=n.prototype}function n(t){function n(t){e(this,t)}return e(n.prototype,t),n}function a(n,a){function o(t){e(this,t)}return t(o,n),e(o.prototype,a),o}return{defineClass:n,extendClass:a,mixin:e}}),n("sensor-applet/mini-event-emitter",[],function(){return{on:function(e,t){this._ee_listeners||(this._ee_listeners={}),this._ee_listeners[e]||(this._ee_listeners[e]=[]),this._ee_listeners[e].push(t)},emit:function(e){var t=arguments.length>1?[].splice.call(arguments,1):[];if(this._ee_listeners&&this._ee_listeners[e])for(var n=0,a=this._ee_listeners[e].length;a>n;n++)this._ee_listeners[e][n].apply(null,t)},removeListener:function(e,t){if(this._ee_listeners&&this._ee_listeners[e])for(var n=0,a=this._ee_listeners[e].length;a>n;n++)this._ee_listeners[e][n]===t&&this._ee_listeners[e].splice(n,1)},removeListeners:function(e){e?this._ee_listeners&&(this._ee_listeners[e]=[]):this._ee_listeners={}}}}),n("common/inherit",[],function(){return function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.superClass=t.prototype,e.prototype.constructor=e}}),n("sensor-applet/errors",["require","common/inherit"],function(e){function t(e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e}function n(){t.apply(this,Array.prototype.slice.apply(arguments))}function a(){t.apply(this,Array.prototype.slice.apply(arguments))}function o(){t.apply(this,Array.prototype.slice.apply(arguments))}function s(){t.apply(this,Array.prototype.slice.apply(arguments))}var r=e("common/inherit");return r(n,Error),r(a,Error),r(o,Error),r(s,Error),{JavaLoadError:n,AppletInitializationError:a,AlreadyReadingError:s,SensorConnectionError:o}}),n("common/actual-root",[],function(){var e,t=/^(\/.+?\/)(interactives|embeddable)\.html$/,n=/(\/.+?\/)(doc|examples|experiments)(\/\w+)*?\/\w+\.html/;return e=document.location.pathname.match(t),e&&e[1]?e[1]:(e=document.location.pathname.match(n),e&&e[1]||"/")}),n("lab.config",["require","common/actual-root"],function(e){var t,n=e("common/actual-root");return t={sharing:!0,logging:!0,tracing:!1,home:"http://lab.ritesproject.net",homeForSharing:null,homeInteractivePath:"/examples/interactives/interactive.html",homeEmbeddablePath:"/examples/interactives/embeddable.html",benchmarkAPIurl:"https://script.google.com/macros/s/AKfycbzosXAVPdVRFUrF6FRI42dzQb2IGLnF9GlIbj9gUpeWpXALKgM/exec",actualRoot:"",utmCampaign:null,fontface:"Lato",hostName:"localhost:9292",authoring:!1,environment:"development","static":!1},t.actualRoot=n,t}),n("common/console",["require","lab.config"],function(e){var t,n,a=e("lab.config"),o=function(){};return"undefined"==typeof console&&(console={},window&&(window.console=console)),n=console,void 0===n.log&&(n.log=o),void 0===n.info&&(n.info=o),void 0===n.warn&&(n.warn=o),void 0===n.error&&(n.error=o),void 0===n.time&&(n.time=o),void 0===n.timeEnd&&(n.timeEnd=o),void 0===n.log.apply&&(n.log=Function.prototype.bind.call(console.log,console)),void 0===n.info.apply&&(n.info=Function.prototype.bind.call(console.info,console)),void 0===n.warn.apply&&(n.warn=Function.prototype.bind.call(console.warn,console)),void 0===n.error.apply&&(n.error=Function.prototype.bind.call(console.error,console)),void 0===n.time.apply&&(n.time=Function.prototype.bind.call(console.time,console)),void 0===n.timeEnd.apply&&(n.timeEnd=Function.prototype.bind.call(console.timeEnd,console)),t={log:function(){a.logging&&n.log.apply(n,arguments)},info:function(){a.logging&&n.info.apply(n,arguments)},warn:function(){a.logging&&n.warn.apply(n,arguments)},error:function(){a.logging&&n.error.apply(n,arguments)},time:function(){a.tracing&&n.time.apply(n,arguments)},timeEnd:function(){a.tracing&&n.timeEnd.apply(n,arguments)}}}),n("sensor-applet/sensor-applet",["require","common/mini-class","./mini-event-emitter","./errors","common/console"],function(e){function t(){var e=null,t=null;this.handleCallback=function(){r.log("handling callback from applet"),setTimeout(function(){return null===e?(r.log("applet called callback after timer expired"),void 0):(window.clearInterval(e),e=null,t.success(),void 0)},5)},this.wait=function(n){var a=0,o=n.times;t=n,e=window.setInterval(function(){a++,a>o&&(window.clearInterval(e),e=null,n.fail())},n.interval)}}var n,a=e("common/mini-class"),o=e("./mini-event-emitter"),s=e("./errors"),r=e("common/console");return n=a.defineClass({listenerPath:"",sensorDefinitions:null,codebase:"",deviceType:"",appletId:"sensor-applet",classNames:"applet sensor-applet",jarUrls:["com/sun/jna/jna.jar","org/concord/sensor/sensor.jar","org/concord/sensor/sensor-applets/sensor-applets.jar"],deviceSpecificJarUrls:[],code:"org.concord.sensor.applet.SensorApplet",testAppletReadyInterval:100,getHTML:function(){var e=this.jarUrls.concat(this.deviceSpecificJarUrls);return["<applet ",'id="',this.appletId,'" ','class="',this.classNames,'" ','archive="',e.join(", "),'" ','code="',this.code,'" ','codebase="',this.codebase,'" ','width="1px" ','height="1px" ','MAYSCRIPT="true" ',">",'<param name="MAYSCRIPT" value="true" />','<param name="evalOnInit" value="'+this.listenerPath+'.appletIsReadyCallback()" />',"</applet>"].join("")},getTestAppletHTML:function(){return["<applet ",'id="',this.appletId,'-test-applet" ','class="applet test-sensor-applet" ','code="org.concord.sensor.applet.DetectionApplet" ','archive="org/concord/sensor/sensor-applets/sensor-applets.jar"','codebase="',this.codebase,'" ','width="150px" ','height="150px" ','style="position: absolute; ',"left: "+($("body").width()/2-75)+"px; ","top: "+($("body").height()/2-75)+'px;" ','MAYSCRIPT="true" ',">",'<param name="MAYSCRIPT" value="true" />','<param name="evalOnInit" value="'+this.listenerPath+'.testAppletIsReadyCallback()" />',"</applet>"].join("")},isSensorConnected:function(e){var t,n,a=this;setTimeout(function(){t=function(o){o?(t=function(){var t=a.appletInstance.getCachedAttachedSensors();if(t)if(1===a.sensorDefinitions.length){for(var n=0;n<t.length;n++)if(a.appletInstance.getTypeConstantName(t[n].getType())===a.sensorDefinitions[0].typeConstantName)return e.call(a,!0),void 0;e.call(a,!1)}else e.call(a,!0);else e.call(a,!1)},n=a.registerCallback(t),a.appletInstance.getAttachedSensors(a.deviceType,""+n)):e.call(a,!1)},n=a.registerCallback(t),a.appletInstance.isInterfaceConnected(a.deviceType,""+n)})},_state:"not appended",getState:function(){return this._state},append:function(e,t){if("not appended"!==this.getState())throw new Error("Can't call append() when sensor applet has left 'not appended' state");r.log("appending test applet"),this.$testAppletContainer=this._appendHTML(this.appletId+"-test-applet-container",this.getTestAppletHTML(),e),this._state="test applet appended",this._waitForTestApplet(),this._appendCallback=t},_appendHTML:function(e,t,n){var a=$("#"+e);return a.length||(a=$("<div id='"+e+"'/>").appendTo(n)),a.html(t),a},_testAppletWaiter:new t,testAppletIsReadyCallback:function(){this._testAppletWaiter.handleCallback()},_waitForTestApplet:function(){var e=this;this._testAppletWaiter.wait({times:30,interval:1e3,success:function(){e.$appletContainer=e._appendHTML(e.appletId+"-container",e.getHTML(),$("body")),e._state="appended",e._waitForApplet()},fail:function(){e._appendCallback(new s.JavaLoadError("Timed out waiting for test applet to initialize."))}})},_appletWaiter:new t,appletIsReadyCallback:function(){this._appletWaiter.handleCallback()},_waitForApplet:function(){var e=this;this._appletWaiter.wait({times:30,interval:1e3,success:function(){var t=[];e.$testAppletContainer.html(""),"appended"===e.getState()&&(e._state="applet ready"),e.appletInstance=$("#"+e.appletId)[0];for(var n=0;n<e.sensorDefinitions.length;n++)t[n]=e.appletInstance.getSensorRequest(e.sensorDefinitions[n].measurementType);e.appletInstance.initSensorInterface(e.listenerPath,e.deviceType,t)},fail:function(){e._appendCallback(new s.AppletInitializationError("Timed out waiting for sensor applet to initialize."))}})},readSensor:function(e){var t=this;return"reading sensor"===this.getState()?(r.log("Already reading sensor in another thread..."),e.call(this,new s.AlreadyReadingError("Already reading sensor in another thread"),null),void 0):"stopped"!==this.getState()?(e.call(this,new Error("Tried to read the sensor value from non-stopped state '"+this.getState()+'"'),null),void 0):(this._state="reading sensor",this.isSensorConnected(function(n){if(n){var a=function(n){t._state="stopped",n&&0!==n.length?e.call(t,null,n):e.call(t,new Error("readSensor: no sensor values to report"),null)},o=t.registerCallback(a);t.appletInstance.getConfiguredSensorsValues(t.deviceType,""+o)}else t._state="stopped",e.call(t,new s.SensorConnectionError("readSensor: sensor is not connected"),null)}),void 0)},start:function(e){var t=this;return"reading sensor"===this.getState()?(r.log("start called while waiting for a sensor reading"),setTimeout(function(){t.start(e)},100),void 0):"stopped"!==this.getState()?(e&&setTimeout(function(){e.call(this,new Error("Tried to start the applet from non-stopped state '"+this.getState()+'"'),!1)},5),void 0):(this._state="starting",this.isSensorConnected(function(n){n?(t.appletInstance.startCollecting(),t._state="started",e&&e.call(t,null,!0)):(t._state="stopped",e&&e.call(t,new s.SensorConnectionError("Device reported the requested sensor type was not attached."),null))}),void 0)},stop:function(){"started"===this.getState()&&(this._state="stopped",this.appletInstance.stopCollecting())},remove:function(){"not appended"!==this.getState()&&(this.$appletContainer&&this.$appletContainer.html(""),this.$testAppletContainer&&this.$testAppletContainer.html(""),this._state="not appended")},initSensorInterfaceComplete:function(e){var t=this;setTimeout(function(){e?(t._state="stopped",t._appendCallback(null),t._appendCallback=null):t._appendCallback(new s.SensorConnectionError("Device reported the requested sensor type was not attached."))},5)},dataReceived:function(e,t,n){var a=this,o=[],s=this.sensorDefinitions.length;setTimeout(function(){n=n||[];for(var e=0;t>e;e++)for(var r=0;s>r;r++)o[r]=n[e*s+r],a.emit("data",o)},5)},deviceUnplugged:function(){var e=this;window.setTimeout(function(){e.emit("deviceUnplugged")},5)},sensorUnplugged:function(){r.log("received sensorUnplugged message; deviceType = "+this.deviceType)},callbackTable:[],registerCallback:function(e){return this.callbackTable.push(e),this.callbackTable.length-1},handleCallback:function(e,t){var n,a=this;"string"==typeof e&&this[e]?n=this[e]:this.callbackTable[e]&&(n=this.callbackTable[e],this.callbackTable[e]=null),n&&setTimeout(function(){n.apply(a,t)},5)}}),a.mixin(n.prototype,o),n}),n("sensor-applet/applet-classes",["require","common/mini-class","./sensor-applet"],function(e){var t=e("common/mini-class"),n=e("./sensor-applet");return{goio:t.extendClass(n,{deviceType:"golink",deviceSpecificJarUrls:["org/concord/sensor/sensor-vernier/sensor-vernier.jar","org/concord/sensor/goio-jna/goio-jna.jar"]}),labquest:t.extendClass(n,{deviceType:"labquest",deviceSpecificJarUrls:["org/concord/sensor/sensor-vernier/sensor-vernier.jar","org/concord/sensor/labquest-jna/labquest-jna.jar"]})}}),n("sensor-applet/sensor-definitions",[],function(){return{goMotion:{appletClass:"goio",measurementName:"Distance",measurementType:"distance",typeConstantName:"distance",sensorName:"GoMotion",deviceName:"GoMotion",samplesPerSecond:20,tareable:!0,minReading:0,maxReading:4,precision:2,maxSeconds:20},goLinkTemperature:{appletClass:"goio",measurementName:"Temperature",measurementType:"temperature",typeConstantName:"temperature",sensorName:"GoIO Temperature Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:40,maxSeconds:20},goLinkLight:{appletClass:"goio",measurementName:"Light Intensity",measurementType:"light",typeConstantName:"light",sensorName:"GoIO Light Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:2e3,maxSeconds:20},goLinkForce:{appletClass:"goio",measurementName:"Force",measurementType:"force",typeConstantName:"force",sensorName:"GoIO Force Sensor",deviceName:"GoIO",samplesPerSecond:20,tareable:!0,minReading:-50,maxReading:50,precision:2,maxSeconds:10},goLinkPH:{appletClass:"goio",measurementName:"Acidity",measurementType:"ph",typeConstantName:"ph",sensorName:"GoIO pH Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:14,maxSeconds:60},goLinkCO2:{appletClass:"goio",measurementName:"CO₂ Concentration",measurementType:"co2",typeConstantName:"co2_gas",sensorName:"GoIO CO₂ sensor",deviceName:"GoIO",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:5e3,maxSeconds:60},goLinkO2:{appletClass:"goio",measurementName:"O₂ Concentration",measurementType:"o2",typeConstantName:"oxygen_gas",sensorName:"GoIO O₂ sensor",deviceName:"GoIO",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:100,maxSeconds:60},labQuestMotion:{appletClass:"labquest",measurementName:"Distance",measurementType:"distance",typeConstantName:"distance",sensorName:"LabQuest Motion Sensor",deviceName:"LabQuest",samplesPerSecond:20,tareable:!0,minReading:0,maxReading:4,precision:2,maxSeconds:20},labQuestTemperature:{appletClass:"labquest",measurementName:"Temperature",measurementType:"temperature",typeConstantName:"temperature",sensorName:"LabQuest Temperature Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:40,maxSeconds:20},labQuestLight:{appletClass:"labquest",measurementName:"Light Intensity",measurementType:"light",typeConstantName:"light",sensorName:"LabQuest Light Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:2e3,maxSeconds:20},labQuestForce:{appletClass:"labquest",measurementName:"Force",measurementType:"force",typeConstantName:"force",sensorName:"LabQuest Force Sensor",deviceName:"LabQuest",samplesPerSecond:20,tareable:!0,minReading:-50,maxReading:50,precision:2,maxSeconds:10},labQuestPH:{appletClass:"labquest",measurementName:"Acidity",measurementType:"ph",typeConstantName:"ph",sensorName:"LabQuest pH Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:14,maxSeconds:60},labQuestCO2:{appletClass:"labquest",measurementName:"CO₂ Concentration",measurementType:"co2",typeConstantName:"co2_gas",sensorName:"LabQuest CO₂ sensor",deviceName:"LabQuest",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:5e3,maxSeconds:60},labQuestO2:{appletClass:"labquest",measurementName:"O₂ Concentration",measurementType:"o2",typeConstantName:"oxygen_gas",sensorName:"LabQuest O₂ sensor",deviceName:"LabQuest",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:100,maxSeconds:60}}}),n("sensor-applet/units-definition",[],function(){return{units:{time:{name:"second",pluralName:"seconds",symbol:"s"},distance:{name:"meter",pluralName:"meters",symbol:"m"},temperature:{name:"degree Celsius",pluaralName:"degrees Celsius",symbol:"°C"},light:{name:"lux",pluralName:"lux",symbol:"lux"},force:{name:"Newton",pluralName:"Newtons",symbol:"N"},ph:{name:"pH Unit",pluralName:"pH Units",symbol:"pH"},co2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"},o2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"}}}}),n("sensor-applet/public-api",["require","sensor-applet/applet-classes","sensor-applet/errors","sensor-applet/sensor-definitions","sensor-applet/units-definition"],function(e){"use strict";window.Lab=window.Lab||{};var t=e("sensor-applet/applet-classes"),n=e("sensor-applet/errors");return window.Lab.sensorApplet={version:"1.0.0",GoIO:t.goio,LabQuest:t.labquest,sensorDefinitions:e("sensor-applet/sensor-definitions"),unitsDefinition:e("sensor-applet/units-definition"),JavaLoadError:n.JavaLoadError,AppletInitializationError:n.AppletInitializationError,SensorConnectionError:n.SensorConnectionError}}),t(["sensor-applet/public-api"],void 0,void 0,!0)}();